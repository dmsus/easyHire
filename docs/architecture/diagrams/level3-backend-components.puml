@startuml Level3_BackendComponents
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Component Diagram for Backend API

Container(backend, "Backend API", "Go, Gin", "Handles business logic and API endpoints")

Component(auth_handler, "Auth Handler", "Gin Handler", "User authentication and JWT management")
Component(assessment_handler, "Assessment Handler", "Gin Handler", "Creates and manages assessments")
Component(user_handler, "User Handler", "Gin Handler", "Manages user profiles and roles")
Component(question_handler, "Question Handler", "Gin Handler", "Question bank and AI integration")
Component(scoring_engine, "Scoring Engine", "Go Service", "Fibonacci-based scoring calculations")
Component(code_execution_client, "Code Execution Client", "Go Client", "Communicates with execution service")
Component(notification_service, "Notification Service", "Go Service", "Sends emails and notifications")

ContainerDb(db, "Database", "PostgreSQL")

Component(user_repo, "User Repository", "GORM", "Data access for users and roles")
Component(assessment_repo, "Assessment Repository", "GORM", "Data access for assessments")
Component(question_repo, "Question Repository", "GORM", "Data access for questions")
Component(result_repo, "Result Repository", "GORM", "Data access for assessment results")
Component(competency_repo, "Competency Repository", "GORM", "Data access for competency matrix")

Rel(auth_handler, user_repo, "Validates users")
Rel(assessment_handler, assessment_repo, "Manages assessments")
Rel(question_handler, question_repo, "Manages questions")
Rel(scoring_engine, result_repo, "Stores results")
Rel(assessment_handler, scoring_engine, "Requests scoring")
Rel(assessment_handler, code_execution_client, "Submits code")
Rel(assessment_handler, notification_service, "Sends notifications")
Rel(question_handler, notification_service, "Notifies experts")

Rel(user_repo, db, "Reads/Writes")
Rel(assessment_repo, db, "Reads/Writes")
Rel(question_repo, db, "Reads/Writes")
Rel(result_repo, db, "Reads/Writes")
Rel(competency_repo, db, "Reads/Writes")

@enduml
